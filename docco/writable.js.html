<!DOCTYPE html>

<html>
<head>
  <title>writable.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>

      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">


                <a class="source" href="base.js.html">
                  base.js
                </a>


                <a class="source" href="readable.js.html">
                  readable.js
                </a>


                <a class="source" href="staccato.js.html">
                  staccato.js
                </a>


                <a class="source" href="writable.js.html">
                  writable.js
                </a>

            </div>
          </div>
        </li>
      </ul>

    <ul class="sections">

          <li id="title">
              <div class="annotation">
                  <h1>writable.js</h1>
              </div>
          </li>



        <li id="section-1">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>Node.js API.</p>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> stream = <span class="hljs-built_in">require</span>(<span class="hljs-string">'stream'</span>)
<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>)</pre></div></div>

        </li>


        <li id="section-2">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Control-flow utilities.</p>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> cadence = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cadence'</span>)
<span class="hljs-keyword">var</span> delta = <span class="hljs-built_in">require</span>(<span class="hljs-string">'delta'</span>)</pre></div></div>

        </li>


        <li id="section-3">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Exceptions you can catch by type.</p>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> interrupt = <span class="hljs-built_in">require</span>(<span class="hljs-string">'interrupt'</span>).createInterrupter(<span class="hljs-string">'staccato'</span>)</pre></div></div>

        </li>


        <li id="section-4">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Return the first not null-like value.</p>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> coalesce = <span class="hljs-built_in">require</span>(<span class="hljs-string">'extant'</span>)</pre></div></div>

        </li>


        <li id="section-5">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Common base class.</p>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> Staccato = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./base'</span>)</pre></div></div>

        </li>


        <li id="section-6">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Construct a new <code>Writable</code> that reads from the given <code>stream</code>. If <code>opening</code>
is true, the <code>ready</code> method will wait until the stream is open.</p>

            </div>

        </li>


        <li id="section-7">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Writable</span> (<span class="hljs-params">stream, opening</span>) </span>{
    Staccato.call(<span class="hljs-keyword">this</span>, stream, opening)
}
util.inherits(Writable, Staccato)</pre></div></div>

        </li>


        <li id="section-8">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Write the given <code>buffer</code> to the stream waiting for the stream to drain if the
buffer is not written successfully. Unlike the Node.js stream write, this
write will return any error reported by the write stream.</p>

            </div>

        </li>


        <li id="section-9">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>Writable.prototype.write = cadence(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">async, buffer</span>) </span>{
    interrupt.assert(!<span class="hljs-keyword">this</span>.destroyed, <span class="hljs-string">'destroyed'</span>, coalesce(<span class="hljs-keyword">this</span>._error))
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.stream.write(buffer)) { <span class="hljs-comment">// &lt;- does this 'error' if `true`?</span>
        interrupt.assert(!<span class="hljs-keyword">this</span>.destroyed, <span class="hljs-string">'destroyed'</span>, coalesce(<span class="hljs-keyword">this</span>._error))
        <span class="hljs-keyword">async</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>._delta = delta(<span class="hljs-keyword">async</span>()).ee(<span class="hljs-keyword">this</span>.stream).on(<span class="hljs-string">'drain'</span>)
        }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>._delta = <span class="hljs-literal">null</span>
        })
    }
})</pre></div></div>

        </li>


        <li id="section-10">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Wait for the underlying stream to finish.</p>

            </div>

        </li>


        <li id="section-11">
            <div class="annotation">

              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>

            </div>

            <div class="content"><div class='highlight'><pre>Writable.prototype.close = cadence(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">async</span>) </span>{
    interrupt.assert(!<span class="hljs-keyword">this</span>.destroyed, <span class="hljs-string">'destroyed'</span>, coalesce(<span class="hljs-keyword">this</span>._error))
    <span class="hljs-keyword">async</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._delta = delta(<span class="hljs-keyword">async</span>()).ee(<span class="hljs-keyword">this</span>.stream).on(<span class="hljs-string">'finish'</span>)
        <span class="hljs-keyword">this</span>.stream.end()
    }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">this</span>._delta = <span class="hljs-literal">null</span>
    })
})

<span class="hljs-built_in">module</span>.exports = Writable</pre></div></div>

        </li>

    </ul>
  </div>
</body>
</html>
